# feishu-doc ä½¿ç”¨è¯´æ˜

è®© AI IDEï¼ˆå¦‚ Windsurfã€Cursor ç­‰ï¼‰ç›´æ¥åœ¨ç»ˆç«¯è¯»å†™é£ä¹¦æ–‡æ¡£ï¼Œæ— éœ€æ‰“å¼€æµè§ˆå™¨ã€‚

**ä¸‹è½½åœ°å€**ï¼šhttps://github.com/hanhx/feishu-doc

---

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…

æ”¯æŒä¸‰ç§å®‰è£…æ–¹å¼ï¼š**AI å®‰è£…ï¼ˆæ¨èï¼‰**ã€**æ‰‹åŠ¨å®‰è£…**ã€**è½¯é“¾æ¥**ã€‚

#### æ–¹å¼ 1ï¼šAI å®‰è£…ï¼ˆæ¨èï¼‰

ç›´æ¥åœ¨ AI IDE ä¸­å‘Šè¯‰ AI åŠ©æ‰‹ï¼š

> "å¸®æˆ‘å®‰è£… feishu-doc skillï¼Œä»“åº“åœ°å€æ˜¯ https://github.com/hanhx/feishu-doc"

AI ä¼šè‡ªåŠ¨è¯†åˆ«å½“å‰ IDE å¹¶å®‰è£…åˆ°æ­£ç¡®çš„ç›®å½•ã€‚

#### æ–¹å¼ 2ï¼šæ‰‹åŠ¨å®‰è£…

æ ¹æ®ä½ ä½¿ç”¨çš„ AI IDEï¼Œé€‰æ‹©å¯¹åº”çš„å‘½ä»¤ï¼š

**Windsurf**
```bash
git clone https://github.com/hanhx/feishu-doc.git ~/.codeium/windsurf/skills/feishu-doc
```

**Cursor**
```bash
git clone https://github.com/hanhx/feishu-doc.git ~/.cursor/skills/feishu-doc
```

**OpenCode**
```bash
git clone https://github.com/hanhx/feishu-doc.git ~/.opencode/skills/feishu-doc
```

**Claude Code**
```bash
git clone https://github.com/hanhx/feishu-doc.git ~/.claude/skills/feishu-doc
```

å®‰è£…å®Œæˆåï¼ŒAI IDE ä¼šè‡ªåŠ¨è¯†åˆ« `SKILL.md` å¹¶åŠ è½½è¯¥ skillã€‚

#### æ–¹å¼ 3ï¼šè½¯é“¾æ¥

å¦‚æœä½ å·²ç»å…‹éš†åˆ°å…¶ä»–ä½ç½®ï¼Œå¯ä»¥åˆ›å»ºè½¯é“¾æ¥ï¼š

```bash
# Windsurf
ln -s /path/to/feishu-doc ~/.codeium/windsurf/skills/feishu-doc

# Cursor
ln -s /path/to/feishu-doc ~/.cursor/skills/feishu-doc

# OpenCode
ln -s /path/to/feishu-doc ~/.opencode/skills/feishu-doc

# Claude Code
ln -s /path/to/feishu-doc ~/.claude/skills/feishu-doc
```

> **ğŸ’¡ æç¤º**ï¼š
> - ä¸åŒ IDE ç‰ˆæœ¬çš„ skills ç›®å½•å¯èƒ½ä¸åŒï¼Œè¯·ä»¥å¯¹åº” IDE å®˜æ–¹æ–‡æ¡£ä¸ºå‡†
> - å¦‚æœä¸‹è½½ zip åŒ…ï¼Œè§£å‹åæ–‡ä»¶å¤¹åä¸º `feishu-doc-main`ï¼Œéœ€é‡å‘½åä¸º `feishu-doc` æˆ–åˆ›å»ºè½¯é“¾æ¥

### 2. é…ç½® App ID å’Œ App Secret

> ğŸ’¡ **æ¨è**ï¼šç›´æ¥è”ç³»ä½œè€…è·å–å·²æ³¨å†Œå¥½çš„ App ID å’Œ App Secretï¼Œæ— éœ€è‡ªå·±åˆ›å»ºåº”ç”¨ã€‚
> 
> å¦‚éœ€è‡ªå·±ç”³è¯·ï¼Œå‚è€ƒ [é™„å½•ï¼šè‡ªå»ºé£ä¹¦åº”ç”¨](#é™„å½•è‡ªå»ºé£ä¹¦åº”ç”¨)ã€‚

æ”¯æŒä¸¤ç§é…ç½®æ–¹å¼ï¼Œ**ç¯å¢ƒå˜é‡ä¼˜å…ˆ**ï¼š

**æ–¹å¼1ï¼šç¯å¢ƒå˜é‡ï¼ˆæ¨èï¼‰**

åœ¨ `~/.zshrc`ï¼ˆMac é»˜è®¤ï¼‰æˆ– `~/.bash_profile` ä¸­æ·»åŠ ï¼š

```bash
export FEISHU_APP_ID=cli_xxxx
export FEISHU_APP_SECRET=xxxx
```

ä¿å­˜åæ‰§è¡Œ `source ~/.zshrc` ç”Ÿæ•ˆã€‚

**æ–¹å¼2ï¼šé…ç½®æ–‡ä»¶**

ç¼–è¾‘ `assets/.feishu`ï¼Œå¡«å…¥ä½ çš„å‡­è¯ï¼š

```
app_id=cli_xxxx
app_secret=xxxx
```

### 3. å¼€å§‹ä½¿ç”¨

é…ç½®å®Œæˆåï¼Œç›´æ¥åœ¨ AI IDE èŠå¤©ä¸­å‘Šè¯‰ AI åŠ©æ‰‹ï¼š

**è¯»å–æ–‡æ¡£**
> "å¸®æˆ‘è¯»ä¸€ä¸‹è¿™ä¸ªé£ä¹¦æ–‡æ¡£ https://xxx.feishu.cn/wiki/TOKEN"

**å†™å…¥æ–‡æ¡£**
> "å¸®æˆ‘æŠŠè¿™ä¸ªæ–¹æ¡ˆå†™åˆ° https://xxx.feishu.cn/wiki/TOKEN"

**æ¸…ç©ºæ–‡æ¡£**
> "å¸®æˆ‘æ¸…ç©º https://xxx.feishu.cn/wiki/TOKEN"

**é¦–æ¬¡ä½¿ç”¨æ—¶**ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹åˆ°æœªç™»å½•å¹¶æ‰“å¼€æµè§ˆå™¨æˆæƒé¡µï¼Œä½ åªéœ€ç‚¹å‡»ã€Œæˆæƒã€å³å¯ã€‚Token è¿‡æœŸæ—¶ä¹Ÿä¼šè‡ªåŠ¨é‡æ–°ç™»å½•ã€‚

---

## æ”¯æŒçš„æ ¼å¼

- æ ‡é¢˜ï¼ˆH1~H9ï¼Œç¬¬ä¸€ä¸ª H1 è‡ªåŠ¨è®¾ä¸ºæ–‡æ¡£æ ‡é¢˜ï¼‰
- ä»£ç å—ï¼ˆè‡ªåŠ¨è¯†åˆ« Javaã€SQLã€JSONã€Pythonã€Goã€Shellã€mermaid ç­‰è¯­è¨€ï¼‰
- æ— åºåˆ—è¡¨ã€æœ‰åºåˆ—è¡¨
- å¾…åŠäº‹é¡¹ï¼ˆ`- [ ]` / `- [x]`ï¼‰
- å¼•ç”¨ï¼ˆæ¸²æŸ“ä¸ºé£ä¹¦ Callout å®¹å™¨ï¼‰
- è¡¨æ ¼ï¼ˆè‡ªåŠ¨æ‹†åˆ†ä¸ºé£ä¹¦åŸç”Ÿè¡¨æ ¼ï¼Œæ¯ä¸ªå­è¡¨æœ€å¤š 8 è¡Œæ•°æ® + 1 è¡Œè¡¨å¤´ï¼Œå¤§è¡¨æ ¼æ— ç¼æ”¯æŒï¼‰
- åˆ†å‰²çº¿
- è¡Œå†…æ ·å¼ï¼š**åŠ ç²—**ã€`è¡Œå†…ä»£ç `ã€~~åˆ é™¤çº¿~~ã€[è¶…é“¾æ¥](url)

---

## å¸¸è§é—®é¢˜

### æƒé™ä¸è¶³ï¼ˆforBiddenï¼‰

æ£€æŸ¥ï¼š
1. åº”ç”¨æ˜¯å¦å·²å¼€é€š `docx:document` å’Œ `docx:document:readonly` æƒé™
2. ä¿®æ”¹æƒé™åæ˜¯å¦é‡æ–°å‘å¸ƒäº†åº”ç”¨ç‰ˆæœ¬
3. æ˜¯å¦é‡æ–°è¿è¡Œäº† `login.py` æˆæƒ

### Token è¿‡æœŸ

**ä¼šè‡ªåŠ¨é‡æ–°ç™»å½•**ï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œã€‚å¦‚éœ€æ‰‹åŠ¨é‡æ–°ç™»å½•æˆ–åˆ‡æ¢è´¦å·ï¼š
```bash
python3 scripts/login.py logout && python3 scripts/login.py
```

### è¡¨æ ¼è¶…è¿‡ 9 è¡Œ

é£ä¹¦ API é™åˆ¶å•æ¬¡åˆ›å»ºè¡¨æ ¼æœ€å¤š 9 è¡Œã€‚è¶…è¿‡ 9 è¡Œçš„è¡¨æ ¼ä¼šè‡ªåŠ¨æ‹†åˆ†ä¸ºå¤šä¸ªå­è¡¨æ ¼ï¼Œæ¯ä¸ªå­è¡¨æœ€å¤š 8 è¡Œæ•°æ® + 1 è¡Œè¡¨å¤´ï¼Œå‡ä¸ºé£ä¹¦åŸç”Ÿè¡¨æ ¼æ¸²æŸ“ã€‚å¦‚æœå­è¡¨åˆ›å»ºå¤±è´¥ï¼Œä¼šè‡ªåŠ¨ fallback ä¸º markdown ä»£ç å—å±•ç¤ºã€‚

---

## å®‰å…¨æ€§è¯´æ˜

### App ID + App Secret

- **è·Ÿåº”ç”¨ç»‘å®šï¼Œä¸è·Ÿä¸ªäººç»‘å®š**ã€‚åŒä¸€ä¸ªé£ä¹¦ç»„ç»‡å†…çš„æˆå‘˜å¯ä»¥å…±ç”¨åŒä¸€å¯¹ app_id / app_secretã€‚
- app_id + app_secret ç”¨äºå¯åŠ¨ OAuth æˆæƒæµç¨‹ï¼Œ**æœ¬èº«ä¸èƒ½ç›´æ¥è®¿é—®ä»»ä½•æ–‡æ¡£**ã€‚
- å»ºè®®ï¼š**ä¸è¦æäº¤åˆ°å…¬å¼€ä»“åº“**ï¼Œé€šè¿‡ `.gitignore` å¿½ç•¥ `assets/.feishu` æ–‡ä»¶ã€‚

### User Access Token

- å¿…é¡»ç”±ç”¨æˆ·æœ¬äººåœ¨æµè§ˆå™¨ä¸­**ç‚¹å‡»æˆæƒ**æ‰èƒ½è·å¾—ï¼Œä»…å‡­ app_id + app_secret æ— æ³•ä¼ªé€ ã€‚
- æƒé™èŒƒå›´ä¸ä½ çš„é£ä¹¦è´¦å·ä¸€è‡´ï¼šä½ èƒ½ç¼–è¾‘çš„æ–‡æ¡£æ‰èƒ½å†™ï¼Œä½ èƒ½æŸ¥çœ‹çš„æ–‡æ¡£æ‰èƒ½è¯»ã€‚
- æœ‰æ•ˆæœŸ 2 å°æ—¶ï¼Œè„šæœ¬è‡ªåŠ¨åˆ·æ–°ã€‚

### Refresh Token

- ç”¨äºåˆ·æ–° access_tokenï¼Œæœ‰æ•ˆæœŸ 30 å¤©ã€‚
- âš ï¸ **æ³„éœ² refresh_token = èº«ä»½è¢«å†’ç”¨**ã€‚è¯·å¦¥å–„ä¿ç®¡ `assets/.user_token_cache` æ–‡ä»¶ï¼Œä¸è¦åˆ†äº«ç»™ä»–äººã€‚

### å‡­è¯é£é™©æ€»ç»“

| å‡­è¯ | èƒ½åšä»€ä¹ˆ | æ³„éœ²é£é™© |
|------|---------|---------|
| app_id + app_secret | å¯åŠ¨ OAuth æˆæƒæµç¨‹ï¼Œæœ¬èº«ä¸èƒ½è®¿é—®æ–‡æ¡£ | ä½ |
| user_access_token | ä»¥ä¸ªäººèº«ä»½è¯»å†™æ–‡æ¡£ï¼ˆ2h è¿‡æœŸï¼‰ | ä¸­ï¼Œä½†éœ€æœ¬äººæˆæƒæ‰èƒ½è·å– |
| refresh_token | åˆ·æ–°å‡ºæ–°çš„ access_tokenï¼ˆ30 å¤©æœ‰æ•ˆï¼‰ | é«˜ï¼Œæ³„éœ²ç­‰äºèº«ä»½å†’ç”¨ |

### å›¢é˜Ÿå…±äº«å»ºè®®

1. **å…±äº« app_id + app_secret**ï¼šå›¢é˜Ÿæˆå‘˜ä½¿ç”¨åŒä¸€ä»½ `.feishu` é…ç½®å³å¯
2. **å„è‡ªç™»å½•**ï¼šæ¯äººè¿è¡Œ `login.py` å®Œæˆä¸ªäººæˆæƒï¼Œtoken ç¼“å­˜äº’ä¸å½±å“
3. **ä¸å…±äº« token ç¼“å­˜**ï¼š`.user_token_cache` æ–‡ä»¶ä»…é™æœ¬äººä½¿ç”¨

---

## é™„å½•ï¼šè‡ªå»ºé£ä¹¦åº”ç”¨

å¦‚æœä¸ä½¿ç”¨ä½œè€…æä¾›çš„ App IDï¼Œå¯ä»¥è‡ªå·±åˆ›å»ºé£ä¹¦åº”ç”¨ï¼š

### 1. åˆ›å»ºåº”ç”¨

1. æ‰“å¼€ [é£ä¹¦å¼€æ”¾å¹³å°](https://open.feishu.cn/app)ï¼Œç™»å½•åç‚¹å‡»ã€Œåˆ›å»ºä¼ä¸šè‡ªå»ºåº”ç”¨ã€
2. å¡«å†™åº”ç”¨åç§°ï¼ˆå¦‚ `Windsurf Doc`ï¼‰ï¼Œåˆ›å»ºå®Œæˆåè¿›å…¥åº”ç”¨è¯¦æƒ…é¡µ
3. è®°å½• **App ID** å’Œ **App Secret**

### 2. å¼€é€šæƒé™

è¿›å…¥åº”ç”¨è¯¦æƒ… â†’ **æƒé™ç®¡ç†** â†’ æœç´¢å¹¶å¼€é€šä»¥ä¸‹æƒé™ï¼š

| æƒé™æ ‡è¯† | è¯´æ˜ | å¿…é¡» |
|---------|------|------|
| `docx:document` | æŸ¥çœ‹ã€ç¼–è¾‘å’Œç®¡ç†äº‘æ–‡æ¡£ | âœ… |
| `docx:document:readonly` | æŸ¥çœ‹äº‘æ–‡æ¡£ | âœ… |

> **è¯»å†™æƒé™ä¸ä½ çš„ä¸ªäººè´¦å·ä¸€è‡´**ï¼šæˆæƒç™»å½•åï¼ŒAI åŠ©æ‰‹ä½¿ç”¨ä½ çš„èº«ä»½è®¿é—®é£ä¹¦ã€‚ä½ èƒ½çœ‹åˆ°çš„æ–‡æ¡£å°±èƒ½è¯»ï¼Œä½ èƒ½ç¼–è¾‘çš„æ–‡æ¡£å°±èƒ½å†™ï¼Œä¸éœ€è¦é¢å¤–ç»™åº”ç”¨åˆ†äº«æ–‡æ¡£æƒé™ã€‚

### 3. å®‰å…¨è®¾ç½®

è¿›å…¥åº”ç”¨è¯¦æƒ… â†’ **å®‰å…¨è®¾ç½®** â†’ **é‡å®šå‘ URL** â†’ æ·»åŠ ï¼š

```
http://127.0.0.1:9999/callback
```

> âš ï¸ å¿…é¡»ä½¿ç”¨ `127.0.0.1`ï¼Œä¸è¦ç”¨ `localhost`ï¼Œå¦åˆ™ä¼šæŠ¥ 20029 é”™è¯¯ã€‚

### 4. å‘å¸ƒåº”ç”¨

è¿›å…¥åº”ç”¨è¯¦æƒ… â†’ **ç‰ˆæœ¬ç®¡ç†ä¸å‘å¸ƒ** â†’ åˆ›å»ºç‰ˆæœ¬ â†’ æäº¤å‘å¸ƒã€‚

> âš ï¸ æ¯æ¬¡ä¿®æ”¹æƒé™åéƒ½éœ€è¦é‡æ–°å‘å¸ƒç‰ˆæœ¬ï¼Œå¦åˆ™æ–°æƒé™ä¸ç”Ÿæ•ˆã€‚

### 5. æ‰‹åŠ¨ç™»å½•ï¼ˆå¯é€‰ï¼‰

å¦‚éœ€æ‰‹åŠ¨è§¦å‘ç™»å½•æµç¨‹ï¼Œåœ¨ skill æ ¹ç›®å½•æ‰§è¡Œï¼š

```bash
python3 scripts/login.py
```

> ğŸ’¡ Windsurf å¸¸è§è·¯å¾„ï¼š`~/.codeium/windsurf/skills/feishu-doc`  
> ğŸ’¡ Cursor å¸¸è§è·¯å¾„ï¼š`~/.cursor/skills/feishu-doc`

**Token æœ‰æ•ˆæœŸ**ï¼š
- **access_token**ï¼š2 å°æ—¶ï¼Œè„šæœ¬è‡ªåŠ¨åˆ·æ–°
- **refresh_token**ï¼š30 å¤©ï¼Œè¿‡æœŸåè‡ªåŠ¨é‡æ–°ç™»å½•
